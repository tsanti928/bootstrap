# This config was adapted from
# https://github.com/samoshkin/tmux-config

# ==========================
# ===  General settings  ===
# ==========================

# Enable 256 colors, https://github.com/tmux/tmux/wiki/FAQ#how-do-i-use-a-256-colour-terminal
# Confusingly, "tmux-256color" actually supports full RGB
set -g default-terminal "tmux-256color"
# Your client terminal likely supports full RGB, so tell tmux
# that it does https://github.com/tmux/tmux/wiki/FAQ#how-do-i-use-rgb-colour
set -ga terminal-features ",*:RGB"
# Some programs ignore the TERM variable & terminfo database and instead
# rely on COLORTERM.
setenv -g COLORTERM "truecolor"
set -g history-limit 10000

# Start at 1 instead of 0 for panes
set -g base-index 1
set -g pane-base-index 1

# Sync with the terminal using OSC 52 sequence
set -g set-clipboard on

# Enable mouse support
set -g mouse on

# ==========================
# ===   Key bindings     ===
# ==========================

# Ctrl Space is the prefix key
unbind C-b
set -g prefix C-space
bind C-space send-prefix

# Mouse select to copy - not require if terminal does it natively
#bind -T copy-mode MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "xclip -in -selection clipboard"
#bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "xclip -in -selection clipboard"

# Pane splits should open to the same path as the current pane
bind '"' split-window -v -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"

# Reload tmux configuration
bind C-r source-file ~/.tmux.conf \; display "Config reloaded"

# Rename session and window
bind r command-prompt -I "#{window_name}" "rename-window '%%'"
bind R command-prompt -I "#{session_name}" "rename-session '%%'"

# Select pane and windows - make the commands repeatable
bind -r p previous-window
bind -r n next-window
bind -r [ select-pane -t :.-
bind -r ] select-pane -t :.+

# ====================
# ===  Appearence  ===
# ====================
color_orange="colour166"
color_green="colour076"
color_blue="colour39"
color_black="colour232"
color_white="white"
color_dark="$color_black"
color_light="$color_white"
color_session_text="$color_blue"
color_status_text="colour245"
color_main="$color_orange"

# Use white as default color for foreground in status
set -g status-fg "$color_white"

# outline for active pane
setw -g pane-active-border-style "fg=$color_main"

set -g mode-style "fg=default,bg=$color_main"

# message line style
set -g message-style "fg=$color_main,bg=$color_dark"

# status line style
set -g status-style "fg=$color_status_text,bg=$color_dark"

# window segments in status line
set -g window-status-separator ""
separator_powerline_left=""
separator_powerline_right=""

setw -g window-status-format " #I:#W "
setw -g window-status-current-style "fg=$color_light,bold,bg=$color_main"
setw -g window-status-current-format "#[fg=$color_dark,bg=$color_main]$separator_powerline_right#[default] #I:#W# #[fg=$color_main,bg=$color_dark]$separator_powerline_right#[default]"

# when window has monitoring notification
setw -g window-status-activity-style "fg=$color_main"

# outline for active pane
setw -g pane-active-border-style "fg=$color_main"

# ====================
# ===  Status bar  ===
# ====================
set -g status on
set -g status-interval 5
set -g status-left "#[fg=$color_session_text] #S #[default]"
set -g status-right "#[fg=$color_light,bg=$color_main] #{?client_prefix,PREFIX,TMUX} #[fg=$color_main,bg=default]#[default] #[fg=$color_blue]CPU:#[default] #(top -b -n 1 | grep 'Cpu(s)' | awk '{print 100 - $8}')% | #[fg=$color_blue]MEM:#[default] #(free -h | grep Mem: | awk '{print $3 \" \" $2}')"
